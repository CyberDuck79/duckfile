version: 1

default:                # default target â‡’ `duck build`
  name: build
  binary: make
  fileFlag: -f
  template:
    repo: https://github.com/CyberDuck79/duckfile-test-templates.git
    ref: main
    path: Makefile.tpl
  variables:
    PROJECT: my-service
    DATE: !cmd date +%Y-%m-%d
  cacheFile: Makefile

targets:
  test:                  # executed with `duck test`
    binary: task
    fileFlag: --taskfile
    template:
      repo: https://github.com/CyberDuck79/duckfile-test-templates.git
      ref: v2.3.0
      path: task/Taskfile.yml.tpl
    variables:
      GO_VERSION: !env GO_VERSION    # falls back to 1.22 if unset
      PLATFORM: linux/amd64
    args: ["--quiet"]

settings:
  logLevel: debug
  allowedHosts:
    - github.com